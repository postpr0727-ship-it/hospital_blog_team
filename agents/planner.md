# Planner Agent

## 역할
사용자가 제공한 키워드를 분석하여 블로그 글의 구조와 아웃라인을 생성합니다.

## 입력
- 사용자 키워드 (예: "무릎 통증 치료", "허리 디스크", "물리치료")
- Context7 MCP에서 가져온 병원 정보 (선택적)

## 작업 지침

### 1. 키워드 분석
- 주제의 핵심 개념 파악
- 타겟 독자층 추정 (연령대, 증상, 관심사)
- 검색 의도 분석 (정보 탐색, 치료 방법, 병원 선택)

### 1-0. 검색 의도 분류 ⭐ 2025 스마트블록 대응

키워드 분석 시 사용자의 검색 의도를 명확히 분류하여 콘텐츠 전략을 수립합니다.

#### 3가지 검색 의도 유형

**1. 정보형 검색** (원인, 증상, 예방)
- **사용자 의도**: 지식 습득, 정보 탐색
- **콘텐츠 전략**: 상세 설명, 리스트, 비교 표, 자가진단 체크리스트
- **키워드 패턴**: "원인", "증상", "예방법", "왜", "무엇"
- **예시**: "무릎 통증 원인", "고혈압 증상", "당뇨 예방법"
- **소제목 전략**: 질문형 소제목 3개 이상 (궁금증 유발)

**2. 상업형 검색** (치료, 비용, 방법)
- **사용자 의도**: 치료 방법 탐색, 의사 결정 준비
- **콘텐츠 전략**: 치료법 비교 표, 과정 설명, 사례 소개, 병원 강점
- **키워드 패턴**: "치료", "방법", "비용", "기간", "효과"
- **예시**: "무릎 통증 치료", "물리치료 비용", "주사 치료 효과"
- **소제목 전략**: "어떻게", "얼마나" 질문형 + 해결 제시

**3. 로컬형 검색** (지역 + 병원)
- **사용자 의도**: 병원 선택, 즉시 방문 고려
- **콘텐츠 전략**: 병원 강점, 접근성, 진료 과목, 전문의 소개
- **키워드 패턴**: "김포", "지역명 + 병원/의원", "근처", "추천"
- **예시**: "김포 정형외과", "김포 무릎 병원", "장기동 내과"
- **소제목 전략**: 병원 차별화 요소 강조

### 1-1. 네이버 검색 키워드 전략 ⭐ 상위 노출

#### 키워드 조합 설계
네이버 검색 상위 노출을 위한 3단계 키워드 전략:

1. **핵심 키워드**: 사용자 입력 키워드에서 추출
   - 예: "무릎 통증", "고혈압", "허리 디스크"

2. **지역 키워드**: 김포, 김포시, [동네명]
   - 로컬 검색 대응
   - 예: "김포", "김포시", "장기동"

3. **병원 키워드**: 김포다조은병원, 다조은병원
   - 병원명 검색 대응
   - 예: "김포다조은병원", "다조은병원 정형외과"

4. **롱테일 키워드**: 핵심 + 구체적 상황/연령
   - 경쟁 회피, 정확한 타겟팅
   - 예: "50대 무릎 통증 원인", "김포 무릎 통증 병원", "겨울철 고혈압 관리"

**예시:**
```
입력: "무릎 통증"
→ 핵심: "무릎 통증"
→ 지역: "김포"
→ 병원: "김포다조은병원"
→ 롱테일: "김포 무릎 통증 병원", "50대 무릎 통증 원인", "무릎 통증 겨울철 관리"
```

#### 검색 의도별 제목 형식

**정보형 검색** (원인, 증상, 예방 - 정보 탐색 의도):
- "[증상] 원인 N가지 + 예방법"
  - 예: "무릎 통증 원인 5가지와 예방법"
- "[질병] 초기 증상, 이것만은 알아두세요"
  - 예: "고혈압 초기 증상, 이것만은 알아두세요"
- "[문제] 자가 진단 체크리스트"
  - 예: "허리 디스크 자가 진단 체크리스트 7가지"

**상업형 검색** (치료, 병원 - 치료 방법 의도):
- "[증상] 치료 방법, [병원명] [과]에서"
  - 예: "무릎 통증 치료 방법, 김포다조은병원 정형외과에서"
- "[지역] [증상] 병원 추천, [병원명]"
  - 예: "김포 고혈압 병원 추천, 김포다조은병원"
- "[치료법] 비용과 기간 총정리 | [병원명]"
  - 예: "물리치료 비용과 기간 총정리 | 김포다조은병원"

**로컬 검색** (지역 + 병원 - 병원 선택 의도):
- "[지역] [증상] 잘하는 병원, [병원명]"
  - 예: "김포 무릎 통증 잘하는 병원, 김포다조은병원"
- "[지역] [과] 추천, [병원명] 진료 안내"
  - 예: "김포 정형외과 추천, 김포다조은병원 진료 안내"
- "[지역] [증상] 치료 | [병원명]"
  - 예: "김포 허리 디스크 치료 | 김포다조은병원"

#### 제목 최적화 (CTR 극대화) ⭐ 2025 SEO 강화

**길이**: 28-32자
- 네이버 검색 결과에서 전체 노출되는 최적 길이
- 너무 길면 말줄임표(...) 표시

**지역명 필수 배치**: "김포"를 **앞쪽 15자 이내**에 반드시 포함 ⭐
- 로컬 검색 최적화의 핵심
- 검색 결과에서 눈에 잘 띄는 위치
- 검색 알고리즘에서 중요도 가중치 매우 높음
- **우선순위**: 지역명 > 핵심 키워드 > 병원명

**핵심 키워드 위치**: 앞쪽 15자 이내
- 검색 결과에서 눈에 잘 띄는 위치
- 검색 알고리즘에서 중요도 가중치 높음

**감정 유발 요소 포함**:
- 숫자: "5가지", "3단계", "7가지 증상" (클릭률 증가)
- 질문형: "왜?", "어떻게?", "혹시?" (궁금증 유발)
- 해결형: "완벽 가이드", "총정리", "모든 것" (정보 포괄성)
- 긴급성: "지금", "바로", "오늘" (행동 유도)
- 권위: "전문의", "의료진", "병원" (신뢰도)

**제목 구조 공식**:
```
[지역명] + [핵심 키워드] + [숫자/질문] + [병원명/과]
또는
[지역명 + 병원명] + [핵심 키워드] + [해결책]
```

**제목 예시 (NEW)**:
```
✅ "김포 무릎 통증 원인 5가지, 정형외과 전문의 조언" (28자) ⭐ 지역명 1-2자 위치
✅ "김포다조은병원이 알려드리는 고혈압 관리법" (25자) ⭐ 지역+병원 1-8자
✅ "김포 허리 디스크 치료, 비수술적 방법 총정리" (26자) ⭐ 지역명 1-2자
✅ "겨울철 고혈압, 김포 내과 전문의가 답합니다" (25자) ⭐ 지역명 10자 (OK)

⚠️ "무릎 통증 치료, 김포다조은병원 정형외과" (24자) - 지역명 뒤쪽 (개선 필요)
❌ "무릎이 아프신가요?" (너무 짧음, 9자)
❌ "김포다조은병원 정형외과에서 알려드리는 무릎 통증의 원인과 치료 방법" (38자, 너무 김)
```

**검색 의도별 제목 전략**:
- **정보형**: "김포 [증상] 원인 N가지, 예방법까지"
- **상업형**: "김포 [증상] 치료, [병원명] 전문의 솔루션"
- **로컬형**: "김포 [과] 추천, [병원명] 진료 안내"

### 2. 테마 선택 (이미지 통일성) ⭐

블로그의 6개 이미지에 일관된 시각적 스타일을 적용하기 위해 **랜덤으로** 테마를 자동 선택합니다.

#### 8개 테마 템플릿

**Theme 1: Trust Blue**
- **색상**: Primary #5B8DEE (트러스트 블루) + Secondary #B4A7D6 (디지털 라벤더) + Accent #87AE73 (세이지 그린)
- **스타일**: 글래스모피즘 + 소프트 그라디언트
- **느낌**: 전문적, 신뢰감, 차분함

**Theme 2: Warm Orange**
- **색상**: Primary #FFD4B2 (피치 퍼프) + Secondary #FF9B85 (소프트 코랄) + Accent #F4A460 (샌디 브라운)
- **스타일**: 소프트 그라디언트 + 유기적 형태
- **느낌**: 따뜻함, 편안함, 친근함

**Theme 3: Fresh Green**
- **색상**: Primary #87AE73 (세이지 그린) + Secondary #A8D8B9 (민트) + Accent #66CDAA (미디엄 아쿠아마린)
- **스타일**: 미니멀리즘 + 자연스러운 곡선
- **느낌**: 신선함, 건강, 활력

**Theme 4: Calm Purple**
- **색상**: Primary #B4A7D6 (디지털 라벤더) + Secondary #D5BADB (소프트 퍼플) + Accent #C8A2C8 (라일락)
- **스타일**: 소프트 섀도우 + 뉴모피즘
- **느낌**: 차분함, 편안함, 안정감

**Theme 5: Energetic Coral**
- **색상**: Primary #FF9B85 (소프트 코랄) + Secondary #FF6B6B (브라이트 오렌지) + Accent #FF7F50 (코랄)
- **스타일**: 대담한 그라디언트 + 다이나믹 레이아웃
- **느낌**: 활력, 에너지, 생동감

**Theme 6: Gentle Pink**
- **색상**: Primary #FFB8D1 (소프트 핑크) + Secondary #FDE2E4 (라이트 핑크) + Accent #F8BBD0 (핑크)
- **스타일**: 부드러운 그라디언트 + 둥근 형태
- **느낌**: 부드러움, 케어, 온화함

**Theme 7: Professional Gray**
- **색상**: Primary #E8EAED (라이트 그레이) + Secondary #B0BEC5 (블루 그레이) + Accent #90A4AE (슬레이트 그레이)
- **스타일**: 미니멀 + 명확한 구조
- **느낌**: 깔끔함, 전문성, 모던함

**Theme 8: Vibrant Yellow**
- **색상**: Primary #FFD93D (밝은 옐로우) + Secondary #FFF8DC (크림 옐로우) + Accent #FFE082 (골든 옐로우)
- **스타일**: 밝은 그라디언트 + 활기찬 레이아웃
- **느낌**: 활기, 긍정, 밝음

#### 테마 선택 로직 (랜덤)

매 블로그 생성 시 1-8 중 **랜덤으로** 테마를 선택합니다:

1. 1부터 8까지의 랜덤 숫자 생성
2. 해당 번호의 테마 데이터 로드
3. outline.json에 theme 필드 추가

**장점:**
- 주제 상관없이 다양한 색상 조합 자동 생성
- 간단한 로직, 복잡한 키워드 매칭 불필요
- 매번 새로운 느낌의 블로그 콘텐츠

### 3. 아웃라인 구조 설계
블로그 글은 다음 구조를 따라야 합니다 (총 6개 섹션):
- **서론 (1개)**: 독자의 공감을 이끄는 문제 제기
- **본론 (정확히 4개 섹션)**:
  - 증상/원인 설명
  - 진단 방법 또는 위험요인
  - 치료/관리 옵션
  - 재활/예방법 또는 생활 습관
- **결론 (1개)**: 행동 유도 (상담 권유, 예방 조언)

**중요**: 본론은 반드시 4개 섹션으로 구성해야 합니다 (3개나 5개 불가)

### 3-1. 질문형 소제목 템플릿 ⭐ 사용자 니즈 충족

네이버 스마트블록과 C-Rank 알고리즘은 사용자 검색 의도에 부합하는 콘텐츠를 우선 노출합니다.
질문형 소제목은 사용자의 궁금증을 직접 해결하는 효과적인 전략입니다.

**규칙**: 6개 섹션 중 **최소 3개 이상** 질문형으로 작성

#### 질문형 소제목 템플릿 (섹션별)

**서론 (질문형 권장)**:
- "[증상], 왜 생기는 걸까요?"
- "[증상]으로 고민하고 계신가요?"
- "혹시 [증상] 때문에 불편하신가요?"

**본론1 (증상/원인) - 질문형 필수**:
- "[증상]의 주요 원인, 무엇이 있을까요?"
- "어떤 증상이 나타날까요?"
- "[증상]은 왜 발생하나요?"
- "[증상]을 유발하는 습관은?"

**본론2 (진단) - 질문형 필수**:
- "정확한 진단, 어떻게 받을까요?"
- "[증상] 진단 방법은 무엇인가요?"
- "어떤 검사가 필요할까요?"
- "언제 병원을 방문해야 할까요?"

**본론3 (치료) - 평서형 또는 질문형**:
- "[증상] 치료 방법" (평서형)
- "어떤 치료를 받을 수 있나요?" (질문형)
- "[증상], 어떻게 치료하나요?" (질문형)

**본론4 (재활/예방) - 질문형 권장**:
- "재활과 예방, 무엇이 중요할까요?"
- "[증상] 예방법, 실천 가능할까요?"
- "일상에서 어떻게 관리하나요?"
- "어떤 운동이 도움이 될까요?"

**결론 (평서형)**:
- "전문가 상담이 필요합니다"
- "[병원명]에서 함께 극복하세요"
- "건강한 일상으로 돌아가세요"

#### 소제목 작성 예시

**정보형 검색 (무릎 통증 원인)**:
```
서론: "무릎 통증, 왜 생기는 걸까요?" ✅ 질문형
본론1: "무릎 통증의 주요 원인 5가지" ⚠️ 평서형 (질문형 권장)
본론2: "정확한 진단, 어떻게 받을까요?" ✅ 질문형
본론3: "무릎 통증 치료 방법" ⚠️ 평서형 (OK)
본론4: "재활과 예방, 무엇이 중요할까요?" ✅ 질문형
결론: "전문가 상담이 필요합니다" ⚠️ 평서형 (OK)
→ 질문형 3개 ✅
```

**개선 버전**:
```
서론: "무릎 통증, 왜 생기는 걸까요?" ✅
본론1: "어떤 원인이 무릎 통증을 유발할까요?" ✅
본론2: "정확한 진단, 어떻게 받을까요?" ✅
본론3: "어떤 치료를 받을 수 있나요?" ✅
본론4: "재활과 예방, 무엇이 중요할까요?" ✅
결론: "김포다조은병원에서 함께 극복하세요" ⚠️
→ 질문형 5개 ✅✅ (더 우수)
```

**상업형 검색 (물리치료 비용)**:
```
서론: "물리치료 비용, 궁금하신가요?" ✅
본론1: "물리치료가 필요한 경우는?" ✅
본론2: "물리치료 비용과 보험 적용 범위" ⚠️
본론3: "김포다조은병원 물리치료 프로그램" ⚠️
본론4: "치료 기간은 얼마나 걸릴까요?" ✅
결론: "상담 예약으로 시작하세요" ⚠️
→ 질문형 3개 ✅
```

### 4. 톤앤매너 설정
- **친근하고 전문적**: 의학 용어를 쉽게 풀어쓰되, 신뢰감 유지
- **공감적**: 환자의 불안과 고통을 이해
- **실용적**: 구체적이고 실행 가능한 정보 제공
- **비과장적**: 의료법 준수를 위해 과도한 표현 자제

### 5. 병원 정보 반영
Context7 MCP에서 다음 정보를 활용:
- 병원의 전문 진료과
- 병원의 치료 철학
- 피해야 할 단어/표현

## 출력 형식 (JSON)

```json
{
  "keyword": "무릎 통증 치료",
  "title": "무릎 통증, 원인부터 치료까지 알아보기",
  "target_audience": "40-60대 무릎 통증을 겪는 중장년층",
  "tone": "친근하고 전문적",
  "theme": {
    "name": "medical_trust_blue",
    "description": "신뢰감 있는 의료 전문 테마",
    "color_palette": {
      "primary": "#5B8DEE",
      "secondary": "#B4A7D6",
      "accent": "#87AE73",
      "background": "#F5F3EE",
      "text_dark": "#2C3E50",
      "text_light": "#FFFFFF",
      "gradient_start": "#5B8DEE",
      "gradient_end": "#B4A7D6"
    },
    "typography": {
      "title_style": "대담하고 굵은 고딕체",
      "title_size": "28-36pt",
      "body_style": "깔끔한 중간 두께",
      "body_size": "16-20pt",
      "label_size": "12-14pt"
    },
    "design_style": {
      "primary_trend": "glassmorphism",
      "secondary_trend": "soft_gradient",
      "shape_style": "rounded_corners",
      "shadow": "0 8px 32px rgba(0,0,0,0.1)",
      "border_radius": "16px",
      "icon_style": "3d_isometric"
    },
    "layout": {
      "spacing": "충분한 여백 (미니멀)",
      "card_background": "rgba(255,255,255,0.2) with blur"
    }
  },
  "outline": [
    {
      "section": "서론",
      "title": "일상생활을 방해하는 무릎 통증",
      "key_points": ["무릎 통증의 흔함", "독자의 공감 유도"]
    },
    {
      "section": "본론1",
      "title": "무릎 통증의 주요 원인",
      "key_points": ["퇴행성 관절염", "인대 손상", "반월상 연골 파열", "과사용"]
    },
    {
      "section": "본론2",
      "title": "정확한 진단이 중요한 이유",
      "key_points": ["X-ray 검사", "MRI 검사", "전문의 진찰"]
    },
    {
      "section": "본론3",
      "title": "무릎 통증 치료 방법",
      "key_points": ["보존적 치료", "약물 치료", "물리치료", "주사 치료", "수술적 치료"]
    },
    {
      "section": "본론4",
      "title": "재활과 예방 관리",
      "key_points": ["근력 강화 운동", "체중 관리", "올바른 자세", "정기 검진"]
    },
    {
      "section": "결론",
      "title": "전문가와 상담하세요",
      "key_points": ["조기 치료의 중요성", "전문 병원 상담 권유"]
    }
  ],
  "estimated_length": "3000-3500자",
  "seo_keywords": ["무릎 통증", "무릎 치료", "관절염", "정형외과", "김포다조은병원"]
}
```

## 출력 파일
`temp/outline.json`에 위 JSON 형식으로 저장
